(this.webpackJsonpvjam=this.webpackJsonpvjam||[]).push([[0],{122:function(e,t,n){e.exports=n.p+"static/media/footsteps.3497fc94.wav"},123:function(e,t,n){e.exports=n.p+"static/media/fireworks.23af77c2.wav"},124:function(e,t,n){e.exports=n.p+"static/media/windandchimes.4a6e1b51.wav"},125:function(e,t,n){e.exports=n.p+"static/media/bonecrack.c37d9ccf.wav"},137:function(e,t,n){e.exports=n(245)},142:function(e,t,n){},150:function(e,t){},152:function(e,t){},237:function(e,t){},238:function(e,t){},245:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),i=n.n(c),o=(n(142),n(7)),u=n(6),s=n(64),l=n(37),f=n(8),m=n(15),d=n(279),g=n(282),b=n(14),p=n.n(b);function v(){var e=Object(o.a)(["\n  margin-top: 92px;\n  text-align: center;\n"]);return v=function(){return e},e}function O(){var e=Object(o.a)(["\n  p {\n    margin-top: 24px;\n    margin-bottom: 24px;\n  }\n"]);return O=function(){return e},e}function h(){var e=Object(o.a)([""]);return h=function(){return e},e}function y(){var e=Object(o.a)(["\n  max-width: 768px;\n  margin: auto;\n  margin-top: 100px;\n"]);return y=function(){return e},e}var E=f.a.div(y()),j=f.a.section(h()),S=f.a.section(O()),w=f.a.div(v()),x=function(){var e=Object(a.useState)(function(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t}(4)),t=Object(m.a)(e,2),n=t[0],c=t[1],i=Object(l.f)();return r.a.createElement(E,null,r.a.createElement(j,null,"Welcome to vjam,",r.a.createElement("br",null),"a virtual jam session for everyone."),r.a.createElement(S,null,r.a.createElement("p",null,"Please enter a valid room id provided by your jam session partners. You can also open a new one by using any random id, which is hopefully not yet taken - good luck."),r.a.createElement(w,null,r.a.createElement(g.a,{value:n,onChange:function(e){return c(e.target.value)}}),r.a.createElement(d.a,{onClick:function(){"running"!==p.a.context.state&&p.a.context.resume(),i.push("rooms/".concat(n))}},"enter"))))},k=n(280);function N(){var e=Object(o.a)(["\n  width: 100%;\n  background-color: lightyellow;\n"]);return N=function(){return e},e}function R(){var e=Object(o.a)(["\n  height: 200px;\n  width: 100%;\n  ","\n"]);return R=function(){return e},e}var J=f.a.div(R(),(function(e){return e.active&&"\n    border: solid darkgreen 3px;\n  "})),D=f.a.div(N()),M=function(e){var t=e.type,n=e.user,a=e.children,c=Object(u.c)((function(e){return e.system.name})),i=Object(u.c)((function(e){return e.band.instruments}))[t];return r.a.createElement(k.a,{item:!0,xs:12,sm:3},r.a.createElement(D,null,t,": ",n),r.a.createElement(J,{active:c==i.user},a))},C=n(121),T=n.n(C).a.connect("wss://try:try@broker.shiftr.io"),U=n(19),A="TRIGGERATTACK",B="TRIGGERRELEASE",H="SETUSER",I={JUNO:"JUNO",RHODES:"RHODES"},W={instruments:{JUNO:{user:"",note:null,velocity:0},RHODES:{user:"",note:null,velocity:0}}},G=function(e,t,n){return{type:A,payload:{instrument:e,note:t,velocity:n}}},P=function(e){return{type:B,payload:{instrument:e}}};function F(){var e=Object(o.a)(["\n  width: 100%;\n  height: 100%;\n  background-color: lightskyblue;\n"]);return F=function(){return e},e}var _=f.a.div(F());var X=["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4"],Y=function(e){var t=e.prefix,n=Object(a.useState)(!1),c=Object(m.a)(n,2),i=c[0],o=c[1],s=Object(a.useState)(null),l=Object(m.a)(s,2),f=l[0],d=l[1],g=Object(a.useState)(!1),p=Object(m.a)(g,2),v=p[0],O=p[1],h=Object(u.c)((function(e){return e.band.instruments.JUNO.note})),y=Object(u.c)((function(e){return e.band.instruments.JUNO.velocity})),E=Object(u.c)((function(e){return e.band.instruments.JUNO.user})),j=Object(u.c)((function(e){return e.system.name})),S=function(){return E===j};return Object(a.useEffect)((function(){if(!i){var e=new b.Synth({oscillator:{type:"sine"},envelope:{attack:.05,decay:.1,sustain:.3,release:1}}),t=new b.Freeverb(.4,1e3),n=new b.PingPongDelay({delayTime:"8n",feedback:.4,wet:.5});e.connect(b.Master),n.connect(t),t.connect(b.Master),d(e),o(!0)}f&&(h?f.triggerAttack(h,0,y):f.triggerRelease())})),r.a.createElement(M,{type:"JUNO",user:E},r.a.createElement(_,{onMouseDown:function(e){if(S()){O(!0);var n=(e.clientX-e.target.getBoundingClientRect().left)/e.target.offsetWidth,a=1-(e.clientY-e.target.getBoundingClientRect().top)/e.target.offsetHeight,r=X[Math.floor(n*X.length)];T.publish(t,JSON.stringify(G(I.JUNO,r,a/2+.5)))}},onMouseMove:function(e){if(S()&&v){var n=(e.clientX-e.target.getBoundingClientRect().left)/e.target.offsetWidth,a=1-(e.clientY-e.target.getBoundingClientRect().top)/e.target.offsetHeight;T.publish(t,JSON.stringify(G(I.JUNO,X[Math.floor(n*X.length)],a/2+.5)))}},onMouseUp:function(e){S()&&(O(!1),T.publish(t,JSON.stringify(P(I.JUNO))))}}))};function K(){var e=Object(o.a)(["\n  width: 100%;\n  height: 100%;\n  background-color: lightgreen;\n"]);return K=function(){return e},e}var q=f.a.div(K());var L=["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4"],z=function(e){var t=e.prefix,n=Object(a.useState)(!1),c=Object(m.a)(n,2),i=c[0],o=c[1],s=Object(a.useState)(null),l=Object(m.a)(s,2),f=l[0],d=l[1],g=Object(a.useState)(!1),p=Object(m.a)(g,2),v=p[0],O=p[1],h=Object(u.c)((function(e){return e.band.instruments.RHODES.note})),y=Object(u.c)((function(e){return e.band.instruments.RHODES.velocity})),E=Object(u.c)((function(e){return e.band.instruments.RHODES.user})),j=Object(u.c)((function(e){return e.system.name})),S=function(){return E===j};return Object(a.useEffect)((function(){if(!i){var e=new b.Synth({frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5}),t=new b.Freeverb(.4,1e3),n=new b.PingPongDelay({delayTime:"8n",feedback:.4,wet:.5});e.connect(b.Master),n.connect(t),t.connect(b.Master),d(e),o(!0)}f&&(h?f.triggerAttack(h,0,y):f.triggerRelease())})),r.a.createElement(M,{type:"RHODES",user:E},r.a.createElement(q,{onMouseDown:function(e){if(S()){O(!0);var n=(e.clientX-e.target.getBoundingClientRect().left)/e.target.offsetWidth,a=1-(e.clientY-e.target.getBoundingClientRect().top)/e.target.offsetHeight,r=L[Math.floor(n*L.length)];T.publish(t,JSON.stringify(G(I.RHODES,r,a/2+.5)))}},onMouseMove:function(e){if(S()&&v){var n=(e.clientX-e.target.getBoundingClientRect().left)/e.target.offsetWidth,a=1-(e.clientY-e.target.getBoundingClientRect().top)/e.target.offsetHeight;T.publish(t,JSON.stringify(G(I.RHODES,L[Math.floor(n*L.length)],a/2+.5)))}},onMouseUp:function(e){S()&&(O(!1),T.publish(t,JSON.stringify(P(I.RHODES))))}}))};n(122),n(123),n(124),n(125);function V(){var e=Object(o.a)(["\n  width: 100%;\n  height: 100%;\n  background-color: red;\n"]);return V=function(){return e},e}f.a.div(V());var $=n(70),Q="ADDUSER",Z="SETUSERS",ee="SETNAME",te={name:"",users:[]},ne=function(e){return{type:ee,payload:{value:e}}};function ae(){var e=Object(o.a)(["\n  background-color: lightpink;\n  padding: 25px;\n  list-style-type: none;\n  li {\n    display: inline-block;\n    margin-right: 15px;\n  }\n"]);return ae=function(){return e},e}var re=f.a.ul(ae()),ce=function(){var e=Object(u.c)((function(e){return e.system.users})),t=Object(u.c)((function(e){return e.system.name}));return r.a.createElement(re,null,e.map((function(e,n){return r.a.createElement("li",{key:n},e!==t&&r.a.createElement("span",null,e),e===t&&r.a.createElement("b",null,e))})))},ie=n(45),oe="ADDMESSAGE",ue={messages:[]},se=n(35),le=Object(se.c)({system:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return Object(U.a)({},e,{users:t.payload.value});case Q:var n=Object($.a)(e.users);return n.includes(t.payload.value)||n.push(t.payload.value),Object(U.a)({},e,{users:n});case ee:if(!e.users.includes(t.payload.value))return Object(U.a)({},e,{name:t.payload.value});default:return e}},band:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:var n=Object(U.a)({},e);return n.instruments[t.payload.instrument].note=t.payload.note,n.instruments[t.payload.instrument].velocity=t.payload.velocity,Object(U.a)({},n);case B:var a=Object(U.a)({},e);return a.instruments[t.payload.instrument].note=null,a.instruments[t.payload.instrument].velocity=0,Object(U.a)({},a);case H:var r=Object(U.a)({},e);return Object.keys(r.instruments).forEach((function(e){r.instruments[e].user===t.payload.user&&(r.instruments[e].user="")})),"NONE"!==t.payload.instrument&&(r.instruments[t.payload.instrument].user=t.payload.user),Object(U.a)({},r);default:return e}},chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oe:var n=Object($.a)(e.messages);return n.unshift(t.payload.message),n=n.splice(0,100),Object(U.a)({},e,{messages:n});default:return e}}}),fe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||se.d,me=Object(se.e)((function(e,t){return"RESET"===t.type?le(void 0,t):"SETSTATE"===t.type?le(t.payload,{type:"IGNORE"}):le(e,t)}),fe(Object(se.a)()));me.dispatch({type:"INIT"});var de=me;function ge(){var e=Object(o.a)([""]);return ge=function(){return e},e}function be(){var e=Object(o.a)(["\n  height: 100px;\n  overflow-y: scroll;\n"]);return be=function(){return e},e}function pe(){var e=Object(o.a)(["\n  background-color: lightcoral;\n  padding: 25px;\n"]);return pe=function(){return e},e}var ve=f.a.div(pe()),Oe=f.a.ul(be()),he=(f.a.section(ge()),function(e){var t,n=e.prefix,c=Object(a.useState)(""),i=Object(m.a)(c,2),o=i[0],s=i[1],l=Object(u.c)((function(e){return e.chat.messages})),f=Object(u.c)((function(e){return e.system.name}));return r.a.createElement(ve,null,r.a.createElement(g.a,(t={fullWidth:!0,value:o},Object(ie.a)(t,"fullWidth",!0),Object(ie.a)(t,"placeholder","something nice you wanna say to your friends"),Object(ie.a)(t,"onChange",(function(e){return s(e.target.value)})),Object(ie.a)(t,"onKeyPress",(function(e){"Enter"===e.key&&(T.publish(n,JSON.stringify(function(e,t){return{type:oe,payload:{message:{sender:e,text:t}}}}(f,o))),s(""))})),t)),r.a.createElement(Oe,null,l.map((function(e,t){return r.a.createElement("li",{key:t},e.sender," > ",e.text)}))))}),ye=n(278),Ee=n(283),je=n(281),Se=n(284);function we(){var e=Object(o.a)(["\n  width: 100%;\n  margin-top: 25px;\n  margin-bottom: 25px;\n"]);return we=function(){return e},e}var xe=f.a.div(we()),ke=function(e){var t,n=e.prefix,a=Object(u.c)((function(e){return e.system.name})),c=Object(u.c)((function(e){return e.band.instruments})),i=Object(u.c)((t=a,function(e){var n="NONE";return Object.keys(e.band.instruments).forEach((function(a){e.band.instruments[a].user===t&&(n=a)})),n}));return r.a.createElement(xe,null,r.a.createElement(k.a,{container:!0},r.a.createElement(k.a,{item:!0,xs:4},r.a.createElement(ye.a,{fullWidth:!0},r.a.createElement(Ee.a,null,"Pick an instrument"),r.a.createElement(je.a,{value:i,onChange:function(e){Object.keys(c).forEach((function(e){""!==c[e].user&&!0})),T.publish(n,JSON.stringify(function(e,t){return{type:H,payload:{instrument:e,user:t}}}(e.target.value,a)))},fullWidth:!0},r.a.createElement(Se.a,{value:"NONE"},"none"),";",Object.keys(I).map((function(e,t){return r.a.createElement(Se.a,{value:I[e],key:t},I[e])})))))))};function Ne(){var e=Object(o.a)(["\n  margin-top: 128px;\n"]);return Ne=function(){return e},e}var Re=f.a.div(Ne()),Je=function(){var e=Object(l.g)().id,t=Object(a.useState)(!1),n=Object(m.a)(t,2),c=n[0],i=n[1],o=Object(a.useState)(""),s=Object(m.a)(o,2),f=s[0],d=s[1],b=Object(u.c)((function(e){return e.system.name})),p=Object(u.b)();return Object(a.useEffect)((function(){e&&!c&&(T.subscribe("vjam/".concat(e),(function(e){e||console.log("subscribed")})),T.subscribe("vjam/".concat(e,"/users/#"),(function(t){t||console.log("subscribed to vjam/".concat(e,"/users/#"))})),T.on("message",(function(t,n){var a;if(t==="vjam/".concat(e))try{a=JSON.parse(n.toString()),de.dispatch(a)}catch(i){}if(t==="vjam/".concat(e,"/users/get")){var r=JSON.parse(n.toString());console.log("get users from",r),r.id!==T.options.clientId&&T.publish("vjam/".concat(e,"/users/set"),JSON.stringify(de.getState().system.users))}if(t==="vjam/".concat(e,"/users/set")){console.log("set users");var c=JSON.parse(n.toString());de.dispatch({type:Z,payload:{value:c}})}})),i(!0),T.publish("vjam/".concat(e,"/users/get"),JSON.stringify({id:T.options.clientId})))})),r.a.createElement(r.a.Fragment,null,""===b&&r.a.createElement(Re,null,r.a.createElement(k.a,{container:!0},r.a.createElement(k.a,{item:!0,xs:2,sm:3}),r.a.createElement(k.a,{item:!0,xs:8,sm:6},"Please let the others know your name. If it is not yet taken, then you will automatically enter the jam session. Submit by pressing return. There will be a button later, do not worry."),r.a.createElement(k.a,{item:!0,xs:2,sm:3}),r.a.createElement(k.a,{item:!0,xs:2,sm:3}),r.a.createElement(k.a,{item:!0,xs:8,sm:6},r.a.createElement(g.a,{fullWidth:!0,value:f,onChange:function(e){d(e.target.value)},onKeyPress:function(t){"Enter"===t.key&&(T.publish("vjam/".concat(e),JSON.stringify({type:Q,payload:{value:f}})),console.log("setname action",ne(f)),p(ne(f)))}})))),""!==b&&r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{container:!0},r.a.createElement(k.a,{item:!0,xs:12},r.a.createElement(ce,null)),r.a.createElement(k.a,{item:!0,xs:12},r.a.createElement(he,{prefix:"vjam/".concat(e)}))),r.a.createElement("h2",null,"Instruments"),r.a.createElement("p",null,"Instrumentes are controlled via the 2d pad, where the x axis is mapped to the pitch and the y axis to the velocity. More instruments and controllable effect parameters, as well as better interactions, will hopefully follow soon."),r.a.createElement(ke,{prefix:"vjam/".concat(e)}),r.a.createElement(k.a,{container:!0,spacing:3},r.a.createElement(Y,{prefix:"vjam/".concat(e)}),r.a.createElement(z,{prefix:"vjam/".concat(e)}))))};function De(){var e=Object(o.a)(["\n  margin-left: 15px;\n  margin-right: 15px;\n"]);return De=function(){return e},e}var Me=f.a.div(De());var Ce=function(){return r.a.createElement(Me,null,r.a.createElement(u.a,{store:de},r.a.createElement(s.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/rooms/:id"},r.a.createElement(Je,null)),r.a.createElement(l.a,{path:"/"},r.a.createElement(x,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[137,1,2]]]);
//# sourceMappingURL=main.124e00a3.chunk.js.map