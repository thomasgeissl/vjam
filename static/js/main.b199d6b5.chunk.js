(this.webpackJsonpvjam=this.webpackJsonpvjam||[]).push([[0],{119:function(e){e.exports=JSON.parse('{"name":"vjam","version":"0.1.1","homepage":"https://thomasgeissl.github.io/vjam/","private":true,"dependencies":{"@material-ui/core":"^4.9.11","@material-ui/icons":"^4.9.1","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.3.2","@testing-library/user-event":"^7.1.2","gh-pages":"^2.2.0","mqtt":"^3.0.0","react":"^16.13.1","react-dom":"^16.13.1","react-redux":"^7.2.0","react-router-dom":"^5.1.2","react-scripts":"3.4.1","react-use-gesture":"^7.0.15","redux":"^4.0.5","redux-observable":"^1.2.0","styled-components":"^5.0.1","tone":"^13.8.25"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"#react-scripts test","eject":"react-scripts eject","deploy":"yarn build && gh-pages -d build","travisdeploy":"CI=false yarn build && gh-pages -d build -r https://$GH_TOKEN@github.com/thomasgeissl/vjam.git","localTest":"yarn build && mkdir vjam && mv build/* vjam && mv vjam build && http-serve build"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},126:function(e,t,n){e.exports=n.p+"static/media/bonecrack.c37d9ccf.wav"},127:function(e,t,n){e.exports=n.p+"static/media/footsteps.3497fc94.wav"},128:function(e,t,n){e.exports=n.p+"static/media/windandchimes.4a6e1b51.wav"},129:function(e,t,n){e.exports=n.p+"static/media/fireworks.23af77c2.wav"},130:function(e,t,n){e.exports=n.p+"static/media/Roland-GR-1-Steel-Drum-C4.777ed87c.wav"},145:function(e,t,n){e.exports=n(254)},150:function(e,t,n){},158:function(e,t){},160:function(e,t){},245:function(e,t){},246:function(e,t){},253:function(e,t,n){e.exports=n.p+"static/media/Kawai-K5000W-Cello-C2.cfbbcfae.wav"},254:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),i=n.n(c),o=(n(150),n(11)),u=n(6),s=n(67),l=n(38),m=n(7),f=n(12),p=n(286),v=n(291),d=n(9),b=n.n(d);function g(){var e=Object(o.a)(["\n  margin-top: 92px;\n  text-align: center;\n"]);return g=function(){return e},e}function y(){var e=Object(o.a)(["\n  p {\n    margin-top: 24px;\n    margin-bottom: 24px;\n  }\n"]);return y=function(){return e},e}function O(){var e=Object(o.a)([""]);return O=function(){return e},e}function j(){var e=Object(o.a)(["\n  position: fixed;\n  padding: 25px;\n  top: 0;\n  right: 0%;\n"]);return j=function(){return e},e}function E(){var e=Object(o.a)(["\n  max-width: 768px;\n  margin: auto;\n  margin-top: 100px;\n"]);return E=function(){return e},e}var h=n(119).version,x=m.a.div(E()),S=m.a.div(j()),w=m.a.section(O()),k=m.a.section(y()),R=m.a.div(g()),N=function(){var e=Object(a.useState)(function(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t}(4)),t=Object(f.a)(e,2),n=t[0],c=t[1],i=Object(l.f)();return r.a.createElement(x,null,r.a.createElement(S,null,h),r.a.createElement(w,null,"Welcome to vjam,",r.a.createElement("br",null),"a virtual jam session for everyone."),r.a.createElement(k,null,r.a.createElement("p",null,"Please enter a valid room id provided by your jam session partners. You can also open a new one by using any random id, which is hopefully not yet taken - good luck."),r.a.createElement(R,null,r.a.createElement(v.a,{value:n,onChange:function(e){return c(e.target.value)}}),r.a.createElement(p.a,{onClick:function(){"running"!==b.a.context.state&&b.a.context.resume(),i.push("rooms/".concat(n))}},"enter"))))},D=n(290),M=n(287),C=n(125),T=n(124),P=n.n(T).a.connect("wss://try:try@broker.shiftr.io"),J=n(19),A="TRIGGERATTACK",U="TRIGGERRELEASE",I="SETUSER",W={JUNO:"JUNO",RHODES:"RHODES",MPC:"MPC",STEELDRUM:"STEELDRUM"},B={instruments:{JUNO:{user:"",note:null,velocity:0},RHODES:{user:"",note:null,velocity:0},MPC:{user:"",note:null,velocity:0},STEELDRUM:{user:"",note:null,velocity:0}}},F=function(e){return function(t){return t.band.instruments[e].note}},G=function(e){return function(t){return t.band.instruments[e].velocity}},_=function(e){return function(t){return t.band.instruments[e].user}},H=function(e,t,n){return{type:A,payload:{instrument:e,note:t,velocity:n}}},K=function(e){return{type:U,payload:{instrument:e}}};function L(){var e=Object(o.a)(["\n  width: 100%;\n  height: 100%;\n  background-color: lightskyblue;\n"]);return L=function(){return e},e}var X=m.a.div(L()),Y=["C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4"],q=function(e){var t=e.active,n=e.type,c=e.prefix,i=function(e){var t=e.event.touches[0],n=e.event.srcElement;if(t&&n){var a=(t.clientX-n.getBoundingClientRect().left)/n.offsetWidth,r=1-(t.clientY-n.getBoundingClientRect().top)/n.offsetHeight;return console.log(a,r),{x:a,y:r}}},o=Object(a.useState)(!1),u=Object(f.a)(o,2),s=u[0],l=u[1],m=Object(a.useRef)(null),p=Object(C.a)({onDrag:function(e){if(t){e.event.preventDefault();var a=i(e);if(a){var r=Y[Math.floor(a.x*Y.length)];P.publish(c,JSON.stringify(H(n,r,a.y/2+.5)))}}},onDragStart:function(e){if(t){console.log(e.event),e.event.preventDefault();var a=i(e);if(a){var r=Y[Math.floor(a.x*Y.length)];P.publish(c,JSON.stringify(H(n,r,a.y/2+.5)))}}},onDragEnd:function(e){t&&(e.event.preventDefault(),P.publish(c,JSON.stringify(K(n))))}},{domTarget:m,eventOptions:{passive:!1}});return r.a.useEffect(p,[p]),r.a.createElement(X,{ref:m,onMouseDown:function(e){if(t){l(!0);var a=(e.clientX-e.target.getBoundingClientRect().left)/e.target.offsetWidth,r=1-(e.clientY-e.target.getBoundingClientRect().top)/e.target.offsetHeight,i=Y[Math.floor(a*Y.length)];P.publish(c,JSON.stringify(H(n,i,r/2+.5)))}},onMouseMove:function(e){if(t&&s){var a=(e.clientX-e.target.getBoundingClientRect().left)/e.target.offsetWidth,r=1-(e.clientY-e.target.getBoundingClientRect().top)/e.target.offsetHeight;P.publish(c,JSON.stringify(H(n,Y[Math.floor(a*Y.length)],r/2+.5)))}},onMouseUp:function(e){t&&(l(!1),P.publish(c,JSON.stringify(K(n))))}})};function $(){var e=Object(o.a)(["\n  width: 100%;\n  background-color: lightyellow;\n"]);return $=function(){return e},e}function z(){var e=Object(o.a)(["\n  height: 200px;\n  width: 100%;\n  ","\n"]);return z=function(){return e},e}var V=m.a.div(z(),(function(e){return e.active&&"\n    border: solid darkgreen 3px;\n  "})),Q=m.a.div($()),Z=function(e){var t=e.type,n=e.user,a=e.children,c=e.inputPad,i=e.prefix,o=Object(u.c)((function(e){return e.system.name})),s=Object(u.c)((function(e){return e.band.instruments}))[t];return r.a.createElement(D.a,{clone:!0,order:s.user===o?1:t.length},r.a.createElement(M.a,{item:!0,xs:12,sm:3},r.a.createElement(Q,null,t,": ",n),r.a.createElement(V,{active:o==s.user},c&&r.a.createElement(q,{type:t,active:n===o,prefix:i}),a)))},ee=function(e){var t=e.type,n=e.prefix,c=Object(a.useState)(!1),i=Object(f.a)(c,2),o=i[0],s=i[1],l=Object(a.useState)(null),m=Object(f.a)(l,2),p=m[0],v=m[1],b=Object(u.c)(F(t)),g=Object(u.c)(G(t)),y=Object(u.c)(_(t));return Object(a.useEffect)((function(){if(!o){var e=new d.Synth({oscillator:{type:"sine"},envelope:{attack:.05,decay:.1,sustain:.3,release:1}}),t=new d.Freeverb(.4,1e3),n=new d.PingPongDelay({delayTime:"8n",feedback:.4,wet:.5});e.connect(d.Master),n.connect(t),t.connect(d.Master),v(e),s(!0)}p&&(b?p.triggerAttack(b,0,g):p.triggerRelease())})),r.a.createElement(Z,{type:t,user:y,inputPad:!0,prefix:n})},te=function(e){var t=e.type,n=e.prefix,c=Object(a.useState)(!1),i=Object(f.a)(c,2),o=i[0],s=i[1],l=Object(a.useState)(null),m=Object(f.a)(l,2),p=m[0],v=m[1],b=Object(a.useState)(!1),g=Object(f.a)(b,2),y=(g[0],g[1],Object(u.c)(F(t))),O=Object(u.c)(G(t)),j=Object(u.c)(_(t));Object(u.c)((function(e){return e.system.name}));return Object(a.useEffect)((function(){if(!o){var e=new d.Synth({frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5}),t=new d.Freeverb(.4,1e3),n=new d.PingPongDelay({delayTime:"8n",feedback:.4,wet:.5});e.connect(d.Master),n.connect(t),t.connect(d.Master),v(e),s(!0)}p&&(y?p.triggerAttack(y,0,O):p.triggerRelease())})),r.a.createElement(Z,{type:t,user:j,inputPad:!0,prefix:n})},ne=n(126),ae=n.n(ne),re=n(127),ce=n.n(re),ie=n(128),oe=n.n(ie),ue=n(129),se=n.n(ue),le=function(e){var t=e.type,n=e.prefix,c=Object(a.useState)(!1),i=Object(f.a)(c,2),o=i[0],s=i[1],l=Object(a.useState)(null),m=Object(f.a)(l,2),p=m[0],v=m[1],b=Object(a.useState)(!1),g=Object(f.a)(b,2),y=(g[0],g[1],Object(u.c)(F(t))),O=(Object(u.c)(G(t)),Object(u.c)(_(t)));return Object(a.useEffect)((function(){if(!o){var e=new d.Sampler({C3:ae.a,F3:ce.a,C4:oe.a,F4:se.a});e.volume.value=-6;var t=new d.Freeverb(.6,5e3),n=new d.PingPongDelay({delayTime:"32n",feedback:.7,wet:.25});e.connect(n),n.connect(t),t.connect(d.Master),v(e),s(!0)}p&&(y?p.triggerAttack(y):p.triggerRelease())})),r.a.createElement(Z,{type:t,user:O,inputPad:!0,prefix:n})},me=function(e){var t=e.prefix,n=e.type,c=e.samples,i=Object(a.useState)(!1),o=Object(f.a)(i,2),s=o[0],l=o[1],m=Object(a.useState)(null),p=Object(f.a)(m,2),v=p[0],b=p[1],g=Object(u.c)(F(n)),y=(Object(u.c)(G(n)),Object(u.c)(_(n)));Object(u.c)((function(e){return e.system.name}));return Object(a.useEffect)((function(){if(!s){var e=new d.Sampler(c);e.volume.value=-6;var t=new d.Freeverb(.6,5e3),n=new d.PingPongDelay({delayTime:"32n",feedback:.7,wet:.25});e.volume.value=-24,e.connect(n),n.connect(t),t.connect(d.Master),b(e),l(!0)}v&&(g?v.triggerAttack(g):v.triggerRelease())})),r.a.createElement(Z,{type:n,user:y,inputPad:!0,prefix:t})},fe=n(73),pe="ADDUSER",ve="SETUSERS",de="SETNAME",be={name:"",users:[]};function ge(){var e=Object(o.a)(["\n  background-color: lightpink;\n  padding: 5px;\n  list-style-type: none;\n  li {\n    display: inline-block;\n    margin-right: 15px;\n  }\n"]);return ge=function(){return e},e}var ye=m.a.ul(ge()),Oe=function(){var e=Object(u.c)((function(e){return e.system.users})),t=Object(u.c)((function(e){return e.system.name}));return r.a.createElement(ye,null,e.map((function(e,n){return r.a.createElement("li",{key:n},e!==t&&r.a.createElement("span",null,e),e===t&&r.a.createElement("b",null,e))})))},je=n(46),Ee="ADDMESSAGE",he={messages:[]},xe=n(36),Se=Object(xe.c)({system:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ve:return Object(J.a)({},e,{users:t.payload.value});case pe:var n=Object(fe.a)(e.users);return n.includes(t.payload.value)||n.push(t.payload.value),Object(J.a)({},e,{users:n});case de:if(!e.users.includes(t.payload.value))return Object(J.a)({},e,{name:t.payload.value});default:return e}},band:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:var n=Object(J.a)({},e);return n.instruments[t.payload.instrument].note=t.payload.note,n.instruments[t.payload.instrument].velocity=t.payload.velocity,Object(J.a)({},n);case U:var a=Object(J.a)({},e);return a.instruments[t.payload.instrument].note=null,a.instruments[t.payload.instrument].velocity=0,Object(J.a)({},a);case I:var r=Object(J.a)({},e);return Object.keys(r.instruments).forEach((function(e){r.instruments[e].user===t.payload.user&&(r.instruments[e].user="")})),"NONE"!==t.payload.instrument&&(r.instruments[t.payload.instrument].user=t.payload.user),Object(J.a)({},r);default:return e}},chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ee:var n=Object(fe.a)(e.messages);return n.unshift(t.payload.message),n=n.splice(0,100),Object(J.a)({},e,{messages:n});default:return e}}}),we=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||xe.d,ke=Object(xe.e)((function(e,t){return"RESET"===t.type?Se(void 0,t):"SETSTATE"===t.type?Se(t.payload,{type:"IGNORE"}):Se(e,t)}),we(Object(xe.a)()));ke.dispatch({type:"INIT"});var Re=ke;function Ne(){var e=Object(o.a)([""]);return Ne=function(){return e},e}function De(){var e=Object(o.a)(["\n  height: 50px;\n  overflow-y: scroll;\n"]);return De=function(){return e},e}function Me(){var e=Object(o.a)(["\n  background-color: lightcoral;\n  padding: 5px;\n"]);return Me=function(){return e},e}var Ce=m.a.div(Me()),Te=m.a.ul(De()),Pe=(m.a.section(Ne()),function(e){var t,n=e.prefix,c=Object(a.useState)(""),i=Object(f.a)(c,2),o=i[0],s=i[1],l=Object(u.c)((function(e){return e.chat.messages})),m=Object(u.c)((function(e){return e.system.name}));return r.a.createElement(Ce,null,r.a.createElement(v.a,(t={fullWidth:!0,value:o},Object(je.a)(t,"fullWidth",!0),Object(je.a)(t,"placeholder","something nice you wanna say to your friends"),Object(je.a)(t,"onChange",(function(e){return s(e.target.value)})),Object(je.a)(t,"onKeyPress",(function(e){"Enter"===e.key&&(P.publish(n,JSON.stringify(function(e,t){return{type:Ee,payload:{message:{sender:e,text:t}}}}(m,o))),s(""))})),t)),r.a.createElement(Te,null,l.map((function(e,t){return r.a.createElement("li",{key:t},e.sender," > ",e.text)}))))}),Je=n(285),Ae=n(292),Ue=n(288),Ie=n(293);function We(){var e=Object(o.a)(["\n  width: 100%;\n  margin-top: 25px;\n  margin-bottom: 25px;\n"]);return We=function(){return e},e}var Be=m.a.div(We()),Fe=function(e){var t,n=e.prefix,a=Object(u.c)((function(e){return e.system.name})),c=Object(u.c)((function(e){return e.band.instruments})),i=Object(u.c)((t=a,function(e){var n="NONE";return Object.keys(e.band.instruments).forEach((function(a){e.band.instruments[a].user===t&&(n=a)})),n}));return r.a.createElement(Be,null,r.a.createElement(M.a,{container:!0},r.a.createElement(M.a,{item:!0,xs:4},r.a.createElement(Je.a,{fullWidth:!0},r.a.createElement(Ae.a,null,"Pick an instrument"),r.a.createElement(Ue.a,{value:i,onChange:function(e){Object.keys(c).forEach((function(e){""!==c[e].user&&!0})),P.publish(n,JSON.stringify(function(e,t){return{type:I,payload:{instrument:e,user:t}}}(e.target.value,a)))},fullWidth:!0},r.a.createElement(Ie.a,{value:"NONE"},"none"),";",Object.keys(W).map((function(e,t){return r.a.createElement(Ie.a,{value:W[e],key:t},W[e])})))))))},Ge=(n(253),n(130));function _e(){var e=Object(o.a)(["\n  margin-top: 128px;\n"]);return _e=function(){return e},e}var He={C4:n.n(Ge).a},Ke=m.a.div(_e()),Le=function(){var e=Object(l.g)().id,t=Object(a.useState)(!1),n=Object(f.a)(t,2),c=n[0],i=n[1],o=Object(a.useState)(""),s=Object(f.a)(o,2),m=s[0],p=s[1],d=Object(u.c)((function(e){return e.system.name})),b=Object(u.b)();return Object(a.useEffect)((function(){e&&!c&&(P.subscribe("vjam/".concat(e),(function(t){t||console.log("subscribed to vjam/".concat(e))})),P.subscribe("vjam/".concat(e,"/users/#"),(function(t){t||console.log("subscribed to vjam/".concat(e,"/users/#"))})),P.on("message",(function(t,n){var a;if(t==="vjam/".concat(e))try{a=JSON.parse(n.toString()),Re.dispatch(a)}catch(c){}t==="vjam/".concat(e,"/users/get")&&(JSON.parse(n.toString()).id!==P.options.clientId&&P.publish("vjam/".concat(e,"/users/set"),JSON.stringify(Re.getState().system.users)));if(t==="vjam/".concat(e,"/users/set")){var r=JSON.parse(n.toString());Re.dispatch({type:ve,payload:{value:r}})}})),i(!0),P.publish("vjam/".concat(e,"/users/get"),JSON.stringify({id:P.options.clientId})))})),r.a.createElement(r.a.Fragment,null,""===d&&r.a.createElement(Ke,null,r.a.createElement(M.a,{container:!0},r.a.createElement(M.a,{item:!0,xs:2,sm:3}),r.a.createElement(M.a,{item:!0,xs:8,sm:6},"Please let the others know your name. If it is not yet taken, then you will automatically enter the jam session. Submit by pressing return."),r.a.createElement(M.a,{item:!0,xs:2,sm:3}),r.a.createElement(M.a,{item:!0,xs:2,sm:3}),r.a.createElement(M.a,{item:!0,xs:8,sm:6},r.a.createElement(v.a,{fullWidth:!0,value:m,onChange:function(e){p(e.target.value)},onKeyPress:function(t){"Enter"===t.key&&(P.publish("vjam/".concat(e),JSON.stringify({type:pe,payload:{value:m}})),b(function(e){return{type:de,payload:{value:e}}}(m)))}})))),""!==d&&r.a.createElement(r.a.Fragment,null,r.a.createElement(M.a,{container:!0},r.a.createElement(M.a,{item:!0,xs:12},r.a.createElement(Oe,null)),r.a.createElement(M.a,{item:!0,xs:12},r.a.createElement(Pe,{prefix:"vjam/".concat(e)}))),r.a.createElement(Fe,{prefix:"vjam/".concat(e)}),r.a.createElement(M.a,{container:!0,spacing:3,justify:"flex-start"},r.a.createElement(ee,{type:W.JUNO,prefix:"vjam/".concat(e)}),r.a.createElement(te,{type:W.RHODES,prefix:"vjam/".concat(e)}),r.a.createElement(le,{type:W.MPC,prefix:"vjam/".concat(e)}),r.a.createElement(me,{type:W.STEELDRUM,samples:He,prefix:"vjam/".concat(e)}))))};function Xe(){var e=Object(o.a)(["\n  margin-left: 15px;\n  margin-right: 15px;\n"]);return Xe=function(){return e},e}var Ye=m.a.div(Xe());var qe=function(){return r.a.createElement(Ye,null,r.a.createElement(u.a,{store:Re},r.a.createElement(s.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/rooms/:id"},r.a.createElement(Le,null)),r.a.createElement(l.a,{path:"/"},r.a.createElement(N,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(qe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[145,1,2]]]);
//# sourceMappingURL=main.b199d6b5.chunk.js.map