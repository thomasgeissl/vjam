{"version":3,"sources":["assets/samples/footsteps.wav","assets/samples/fireworks.wav","assets/samples/windandchimes.wav","assets/samples/bonecrack.wav","components/Home.js","components/instruments/Wrapper.js","mqtt.js","store/reducers/band.js","components/instruments/Juno.js","components/instruments/Rhodes.js","components/instruments/Sampler.js","store/reducers/system.js","store/reducers/rootReducer.js","store/index.js","components/Room.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","Container","styled","div","Intro","section","RoomChooser","Door","useState","length","result","characters","charactersLength","i","charAt","Math","floor","random","generateId","room","setRoom","history","useHistory","TextField","value","onChange","event","target","Button","onClick","Tone","context","state","resume","push","children","Grid","item","xs","sm","client","mqtt","connect","types","instruments","defaultState","JUNO","note","velocity","RHODES","triggerAttack","instrument","type","payload","triggerRelease","Input","scale","prefix","patched","setPatched","setInstrument","mouseDown","setMouseDown","useSelector","band","useEffect","pad","Synth","oscillator","envelope","attack","decay","sustain","release","reverb","Freeverb","pingPongDelay","PingPongDelay","delayTime","feedback","wet","Master","Wrapper","onMouseDown","x","clientX","getBoundingClientRect","left","offsetWidth","y","clientY","top","offsetHeight","n","publish","JSON","stringify","onMouseMove","onMouseUp","inst","frequency","harmonicity","modulationIndex","resonance","octaves","appReducer","combineReducers","system","action","temperature","current","program","newState","composeEnhancer","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","undefined","applyMiddleware","dispatch","id","useParams","subscribe","err","console","log","on","topic","message","parse","toString","e","Juno","Rhodes","App","className","path","Room","Home","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.e600110e.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/footsteps.3497fc94.wav\";","module.exports = __webpack_public_path__ + \"static/media/fireworks.23af77c2.wav\";","module.exports = __webpack_public_path__ + \"static/media/windandchimes.4a6e1b51.wav\";","module.exports = __webpack_public_path__ + \"static/media/bonecrack.c37d9ccf.wav\";","import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Button from \"@material-ui/core/Button\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Tone from \"tone\";\nimport styled from \"styled-components\";\n\nconst Container = styled.div`\n  max-width: 768px;\n  margin: auto;\n  margin-top: 100px;\n`;\nconst Intro = styled.section``;\nconst RoomChooser = styled.section`\n  p {\n    margin-top: 24px;\n    margin-bottom: 24px;\n  }\n`;\nconst Door = styled.div`\n  margin-top: 92px;\n  text-align: center;\n`;\nconst generateId = (length) => {\n  var result = \"\";\n  var characters = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n  var charactersLength = characters.length;\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n};\nexport default () => {\n  const [room, setRoom] = useState(generateId(4));\n  const history = useHistory();\n  return (\n    <Container>\n      <Intro>\n        Welcome to vjam,<br></br>a virtual jam session for everyone.\n      </Intro>\n      <RoomChooser>\n        <p>\n          Please enter a valid room id provided by your jam session partners.\n          You can also open a new one by using any random id, which is hopefully\n          not yet taken - good luck.\n        </p>\n        <Door>\n          <TextField\n            value={room}\n            onChange={(event) => setRoom(event.target.value)}\n          ></TextField>\n          <Button\n            onClick={() => {\n              if (Tone.context.state !== \"running\") {\n                Tone.context.resume();\n              }\n              history.push(`rooms/${room}`);\n            }}\n          >\n            enter\n          </Button>\n        </Door>\n      </RoomChooser>\n    </Container>\n  );\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport Grid from \"@material-ui/core/Grid\";\n\nconst Container = styled.div`\n  height: 200px;\n  width: 100%;\n`;\nexport default ({ children }) => {\n  return (\n    <Grid item xs={12} sm={3}>\n      <Container>{children}</Container>\n    </Grid>\n  );\n};\n","import mqtt from \"mqtt\";\n// const client = mqtt.connect(\"ws://localhost:9001\");\nconst client = mqtt.connect(\"wss://try:try@broker.shiftr.io\");\nexport default client;\n","const types = {\n  TRIGGERATTACK: \"TRIGGERATTACK\",\n  TRIGGERRELEASE: \"TRIGGERRELEASE\",\n};\nconst instruments = {\n  JUNO: \"JUNO\",\n  RHODES: \"RHODES\",\n};\n\nconst defaultState = {\n  instruments: {\n    JUNO: { note: null, velocity: 0 },\n    RHODES: { note: null, velocity: 0 },\n  },\n};\n\nexport default (state = defaultState, action) => {\n  switch (action.type) {\n    case types.TRIGGERATTACK: {\n      let newState = { ...state };\n      newState.instruments[action.payload.instrument].note =\n        action.payload.note;\n      newState.instruments[action.payload.instrument].velocity =\n        action.payload.velocity;\n      return newState;\n    }\n    case types.TRIGGERRELEASE: {\n      let newState = { ...state };\n      newState.instruments[action.payload.instrument].note = null;\n      newState.instruments[action.payload.instrument].velocity = 0;\n      return { ...newState };\n    }\n    default:\n      return state;\n  }\n};\n\nexport const triggerAttack = (instrument, note, velocity) => {\n  return {\n    type: types.TRIGGERATTACK,\n    payload: {\n      instrument,\n      note,\n      velocity,\n    },\n  };\n};\nexport const triggerRelease = (instrument) => {\n  return {\n    type: types.TRIGGERRELEASE,\n    payload: {\n      instrument,\n    },\n  };\n};\nexport { types, instruments };\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Synth, Freeverb, PingPongDelay, PolySynth, Master } from \"tone\";\nimport Wrapper from \"./Wrapper\";\nimport client from \"../../mqtt\";\n\nimport {\n  instruments,\n  triggerAttack,\n  triggerRelease,\n} from \"../../store/reducers/band\";\n\nimport styled from \"styled-components\";\n\nconst Input = styled.div`\n  width: 100%;\n  height: 100%;\n  background-color: blue;\n`;\n\nfunction map_range(value, low1, high1, low2, high2) {\n  return low2 + ((high2 - low2) * (value - low1)) / (high1 - low1);\n}\n\nconst scale = [\n  \"C3\",\n  \"D3\",\n  \"E3\",\n  \"F3\",\n  \"G3\",\n  \"A3\",\n  \"B3\",\n  \"C4\",\n  \"D4\",\n  \"E4\",\n  \"F4\",\n  \"G4\",\n  \"A4\",\n  \"B4\",\n];\n\nexport default ({ prefix }) => {\n  const [patched, setPatched] = useState(false);\n  const [instrument, setInstrument] = useState(null);\n  const [mouseDown, setMouseDown] = useState(false);\n  const note = useSelector((state) => state.band.instruments.JUNO.note);\n  const velocity = useSelector((state) => state.band.instruments.JUNO.velocity);\n\n  useEffect(() => {\n    if (!patched) {\n      const pad = new Synth({\n        oscillator: {\n          type: \"sine\",\n        },\n        envelope: {\n          attack: 0.05,\n          decay: 0.1,\n          sustain: 0.3,\n          release: 1,\n        },\n      });\n      const reverb = new Freeverb(0.4, 1000);\n      const pingPongDelay = new PingPongDelay({\n        delayTime: \"8n\",\n        feedback: 0.4,\n        wet: 0.5,\n      });\n      pad.connect(Master);\n      pingPongDelay.connect(reverb);\n      reverb.connect(Master);\n      setInstrument(pad);\n      setPatched(true);\n    }\n    if (instrument) {\n      if (note) {\n        instrument.triggerAttack(note, 0, velocity);\n      } else {\n        instrument.triggerRelease();\n      }\n    }\n  });\n\n  return (\n    <Wrapper>\n      <Input\n        onMouseDown={(event) => {\n          setMouseDown(true);\n          const x =\n            (event.clientX - event.target.getBoundingClientRect().left) /\n            event.target.offsetWidth;\n          const y =\n            1 -\n            (event.clientY - event.target.getBoundingClientRect().top) /\n              event.target.offsetHeight;\n\n          const n = scale[Math.floor(x * scale.length)];\n          client.publish(\n            prefix,\n            JSON.stringify(triggerAttack(instruments.JUNO, n, y / 2 + 0.5))\n          );\n        }}\n        onMouseMove={(event) => {\n          if (mouseDown) {\n            const x =\n              (event.clientX - event.target.getBoundingClientRect().left) /\n              event.target.offsetWidth;\n            const y =\n              1 -\n              (event.clientY - event.target.getBoundingClientRect().top) /\n                event.target.offsetHeight;\n            client.publish(\n              prefix,\n              JSON.stringify(\n                triggerAttack(\n                  instruments.JUNO,\n                  scale[Math.floor(x * scale.length)],\n                  y / 2 + 0.5\n                )\n              )\n            );\n          }\n        }}\n        onMouseUp={(event) => {\n          setMouseDown(false);\n          client.publish(\n            prefix,\n            JSON.stringify(triggerRelease(instruments.JUNO))\n          );\n        }}\n      ></Input>\n    </Wrapper>\n  );\n};\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Synth, Freeverb, PingPongDelay, MetalSynth, Master } from \"tone\";\nimport Wrapper from \"./Wrapper\";\nimport client from \"../../mqtt\";\n\nimport {\n  instruments,\n  triggerAttack,\n  triggerRelease,\n} from \"../../store/reducers/band\";\n\nimport styled from \"styled-components\";\n\nconst Input = styled.div`\n  width: 100%;\n  height: 100%;\n  background-color: lightgreen;\n`;\n\nfunction map_range(value, low1, high1, low2, high2) {\n  return low2 + ((high2 - low2) * (value - low1)) / (high1 - low1);\n}\n\nconst scale = [\n  \"C3\",\n  \"D3\",\n  \"E3\",\n  \"F3\",\n  \"G3\",\n  \"A3\",\n  \"B3\",\n  \"C4\",\n  \"D4\",\n  \"E4\",\n  \"F4\",\n  \"G4\",\n  \"A4\",\n  \"B4\",\n];\n\nexport default ({ prefix }) => {\n  const [patched, setPatched] = useState(false);\n  const [instrument, setInstrument] = useState(null);\n  const [mouseDown, setMouseDown] = useState(false);\n  const note = useSelector((state) => state.band.instruments.RHODES.note);\n  const velocity = useSelector(\n    (state) => state.band.instruments.RHODES.velocity\n  );\n\n  useEffect(() => {\n    if (!patched) {\n      const inst = new Synth({\n        frequency: 200,\n        envelope: {\n          attack: 0.001,\n          decay: 1.4,\n          release: 0.2,\n        },\n        harmonicity: 5.1,\n        modulationIndex: 32,\n        resonance: 4000,\n        octaves: 1.5,\n      });\n      const reverb = new Freeverb(0.4, 1000);\n      const pingPongDelay = new PingPongDelay({\n        delayTime: \"8n\",\n        feedback: 0.4,\n        wet: 0.5,\n      });\n      inst.connect(Master);\n      pingPongDelay.connect(reverb);\n      reverb.connect(Master);\n      setInstrument(inst);\n      setPatched(true);\n    }\n    if (instrument) {\n      if (note) {\n        instrument.triggerAttack(note, 0, velocity);\n      } else {\n        instrument.triggerRelease();\n      }\n    }\n  });\n\n  return (\n    <Wrapper>\n      <Input\n        onMouseDown={(event) => {\n          setMouseDown(true);\n          const x =\n            (event.clientX - event.target.getBoundingClientRect().left) /\n            event.target.offsetWidth;\n          const y =\n            1 -\n            (event.clientY - event.target.getBoundingClientRect().top) /\n              event.target.offsetHeight;\n\n          const n = scale[Math.floor(x * scale.length)];\n          client.publish(\n            prefix,\n            JSON.stringify(triggerAttack(instruments.RHODES, n, y / 2 + 0.5))\n          );\n        }}\n        onMouseMove={(event) => {\n          if (mouseDown) {\n            const x =\n              (event.clientX - event.target.getBoundingClientRect().left) /\n              event.target.offsetWidth;\n            const y =\n              1 -\n              (event.clientY - event.target.getBoundingClientRect().top) /\n                event.target.offsetHeight;\n            client.publish(\n              prefix,\n              JSON.stringify(\n                triggerAttack(\n                  instruments.RHODES,\n                  scale[Math.floor(x * scale.length)],\n                  y / 2 + 0.5\n                )\n              )\n            );\n          }\n        }}\n        onMouseUp={(event) => {\n          setMouseDown(false);\n          client.publish(\n            prefix,\n            JSON.stringify(triggerRelease(instruments.RHODES))\n          );\n        }}\n      ></Input>\n    </Wrapper>\n  );\n};\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport { Synth, Sampler, Reverb, PingPongDelay, Master } from \"tone\";\nimport Wrapper from \"./Wrapper\";\n\nimport { triggerAttack, triggerRelease } from \"../../store/reducers/band\";\n\nimport client from \"../../mqtt\";\n\nimport footsteps from \"../../assets/samples/footsteps.wav\";\nimport fireworks from \"../../assets/samples/fireworks.wav\";\nimport wind from \"../../assets/samples/windandchimes.wav\";\nimport bonecrack from \"../../assets/samples/bonecrack.wav\";\n\nconst Input = styled.div`\n  width: 100%;\n  height: 100%;\n  background-color: red;\n`;\n\nfunction map_range(value, low1, high1, low2, high2) {\n  return low2 + ((high2 - low2) * (value - low1)) / (high1 - low1);\n}\n\nconst scale = [\"C3\", \"D3\", \"E3\", \"F3\"];\n\nexport default () => {\n  const [mounted, setMounted] = useState(false);\n  const [mouseDown, setMouseDown] = useState(false);\n  const synthRef = useRef(null);\n  const band = useSelector((state) => state.band);\n  const note = band.padNote;\n  const velocity = band.padVelocity;\n\n  const sampler = new Sampler(\n    {\n      C3: bonecrack,\n      D3: wind,\n      E3: fireworks,\n      F3: footsteps,\n    },\n    {\n      onload: () => {\n        sampler.triggerAttack(\"C3\");\n      },\n    }\n  );\n\n  const reverb = new Reverb({ decay: 4 });\n\n  useEffect(() => {\n    if (!mounted) {\n      sampler.connect(reverb);\n      synthRef.current = sampler;\n      reverb.connect(Master);\n      setMounted(true);\n    }\n    if (note) {\n      // synthRef.current.triggerAttack(note, 0, velocity);\n    } else {\n      // synthRef.current.triggerRelease();\n    }\n  });\n\n  return (\n    <Wrapper>\n      <Input\n        // ref={synthRef}\n        onMouseDown={(event) => {\n          synthRef.current.triggerAttack(\"C3\");\n          // setMouseDown(true);\n          const x =\n            (event.clientX - event.target.getBoundingClientRect().left) /\n            event.target.offsetWidth;\n          const y =\n            1 -\n            (event.clientY - event.target.getBoundingClientRect().top) /\n              event.target.offsetHeight;\n          console.log(y);\n          // client.publish(\n          //   \"redux\",\n          //   JSON.stringify(\n          //     triggerAttack(scale[Math.floor(x * scale.length)], y)\n          //   )\n          // );\n        }}\n        onMouseMove={(event) => {\n          if (mouseDown) {\n            const x =\n              (event.clientX - event.target.getBoundingClientRect().left) /\n              event.target.offsetWidth;\n            const y =\n              1 -\n              (event.clientY - event.target.getBoundingClientRect().top) /\n                event.target.offsetHeight;\n            client.publish(\n              \"redux\",\n              JSON.stringify(\n                triggerAttack(scale[Math.floor(x * scale.length)], y)\n              )\n            );\n          }\n          // synthRef.current.triggerAttack(note);\n          // console.log(\"mouseDown\", synthA);\n        }}\n        onMouseUp={(event) => {\n          setMouseDown(false);\n          client.publish(\"redux\", JSON.stringify(triggerRelease()));\n        }}\n      ></Input>\n    </Wrapper>\n  );\n};\n","const types = {\n  SETTEMPERATURE: \"SETTEMPERATURE\",\n  SETCURRENT: \"SETCURRENT\",\n  SETPROGRAM: \"SETPROGRAM\",\n};\n\nconst defaultState = {};\n\nexport default (state = defaultState, action) => {\n  switch (action.type) {\n    case types.SETTEMPERATURE: {\n      return {\n        ...state,\n        temperature: action.payload.value,\n      };\n    }\n    case types.SETCURRENT: {\n      return {\n        ...state,\n        current: action.payload.value,\n      };\n    }\n    case types.SETPROGRAM: {\n      return {\n        ...state,\n        program: action.payload.value,\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nexport const setTemperature = (value) => {\n  return {\n    type: types.SETTEMPERATURE,\n    payload: {\n      value,\n    },\n  };\n};\nexport const setCurrent = (value) => {\n  return {\n    type: types.SETCURRENT,\n    payload: {\n      value,\n    },\n  };\n};\nexport const setProgram = (value) => {\n  return {\n    type: types.SETPROGRAM,\n    payload: {\n      value,\n    },\n  };\n};\nexport { types };\n","import { combineReducers } from \"redux\";\n\nimport system from \"./system\";\nimport band from \"./band\";\n\nconst appReducer = combineReducers({\n  system,\n  band,\n});\n\nexport default (state, action) => {\n  if (action.type === \"RESET\") {\n    return appReducer(undefined, action);\n  } else if (action.type === \"SETSTATE\") {\n    return appReducer(action.payload, {\n      type: \"IGNORE\",\n    });\n  } else {\n    return appReducer(state, action);\n  }\n};\n","import { createStore, applyMiddleware, compose } from \"redux\";\nimport { createEpicMiddleware } from \"redux-observable\";\n\nimport rootReducer from \"./reducers/rootReducer\";\n// import rootEpic from './epics/rootEpic'\n\n// const epicMiddleware = createEpicMiddleware()\nconst composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst store = createStore(\n  rootReducer,\n  composeEnhancer(\n    applyMiddleware()\n    // epicMiddleware\n  )\n);\n\n// epicMiddleware.run(rootEpic);\n// store.subscribe(() => console.log(store.getState()))\nstore.dispatch({\n  type: \"INIT\"\n});\n\nexport default store;\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport Juno from \"./instruments/Juno\";\nimport Rhodes from \"./instruments/Rhodes\";\nimport Sampler from \"./instruments/Sampler\";\n\nimport store from \"../store\";\nimport client from \"../mqtt\";\nexport default () => {\n  const { id } = useParams();\n  const [patched, setPatched] = useState(false);\n  useEffect(() => {\n    if (id && !patched) {\n      // client.on(\"connect\", function () {\n      client.subscribe(`vjam/${id}`, function (err) {\n        if (!err) {\n          console.log(\"subscribed\");\n        }\n      });\n      // });\n\n      client.on(\"message\", function (topic, message) {\n        if (topic === `vjam/${id}`) {\n          let action;\n          try {\n            action = JSON.parse(message.toString());\n            store.dispatch(action);\n          } catch (e) {}\n        }\n      });\n\n      setPatched(true);\n    }\n  });\n  return (\n    <>\n      <Juno prefix={`vjam/${id}`}></Juno>\n      <Rhodes prefix={`vjam/${id}`}></Rhodes>\n      {/* <Sampler prefix={`vjam/${id}`}></Sampler> */}\n    </>\n  );\n};\n","import React from \"react\";\nimport { Provider } from \"react-redux\";\n// import \"./App.css\";\nimport { HashRouter as Router, Switch, Route, Link } from \"react-router-dom\";\n\nimport Home from \"./components/Home\";\nimport Lobby from \"./components/Lobby\";\nimport Room from \"./components/Room\";\n\nimport store from \"./store\";\n\nfunction App() {\n  return (\n    <Provider store={store}>\n      <div className=\"App\">\n        <Router>\n          <Switch>\n            <Route path=\"/rooms/:id\">\n              <Room />\n            </Route>\n            <Route path=\"/\">\n              <Home />\n            </Route>\n          </Switch>\n        </Router>\n      </div>\n    </Provider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}